modeling2 <- full_join(modeling2, mswabreg, by = "locid")
modeling2 <- full_join(modeling2, mswabdef, by = "locid")
modeling22 <- modeling2[complete.cases(modeling2$mswabec_lncon), ]
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mpartec_lncon + mwaterec_lncon +
mswabec_lncon + mswabdefec_lncon, data = modeling22)
colnames(modeling22)
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mpartec_lncon + mwaterec_lncon +
mswabdefec_lncon, data = modeling22)
modeling2 <- full_join(hr, mpart, by = "locid")
modeling2 <- full_join(modeling2, mwater, by = "locid")
modeling2 <- full_join(modeling2, mswab, by = "locid")
modeling2 <- full_join(modeling2, mswabirreg, by = "locid")
modeling2 <- full_join(modeling2, mswabreg, by = "locid")
modeling2 <- full_join(modeling2, mswabdef, by = "locid")
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mpartec_lncon + mwaterec_lncon +
mswabdefec_lncon, data = modeling2)
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mpartec_lncon + mwaterec_lncon +
mswabdefec_lncon, data = modeling2, na.action=na.omit)
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mwaterec_lncon +
mswabdefec_lncon, data = modeling2)
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mwaterec_lncon +
mswabec_lncon, data = modeling2)
summary(fit)
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mwaterec_lncon +
mswabdefec_lncon, data = modeling2)
View(modeling2)
modeling22 <- modeling2[complete.cases(modeling2$mswabdefec_lncon), ]
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mpartec_lncon + mwaterec_lncon +
mswabec_lncon, data = modeling22)
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mwaterec_lncon + mswabdefec_lncon, data = modeling2)
summary(fit)
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mwaterec_lncon + mswabdefec_lncon, data = modeling2)
View(modeling22)
fit <- lm(hrec_lncon ~ neighbor + hr_sex  + mswabdefec_lncon, data = modeling2)
summary(fit)
View(modeling22)
View(modeling2)
View(modeling22)
View(swabdef)
swabdef1 <- df.envir %>%  filter(samtype == 9 & sw_def == 0) %>% select(locid, swabdefec_lncon = ec_lncon) %>% subset(!is.na(locid))
mswabdef1 <- swabdef1 %>% group_by(locid) %>% summarise_each(funs(mswabdefec_lncon = mean(., na.rm=TRUE)))
View(mswabdef1)
modeling2 <- full_join(modeling2, mswabdef1, by = "locid")
swabdef1 <- df.envir %>%  filter(samtype == 9 & sw_def == 0) %>% select(locid, swabdef1ec_lncon = ec_lncon) %>% subset(!is.na(locid))
mswabdef1 <- swabdef1 %>% group_by(locid) %>% summarise_each(funs(mswabdef1ec_lncon = mean(., na.rm=TRUE)))
modeling2 <- full_join(hr, mpart, by = "locid")
modeling2 <- full_join(modeling2, mwater, by = "locid")
modeling2 <- full_join(modeling2, mswab, by = "locid")
modeling2 <- full_join(modeling2, mswabirreg, by = "locid")
modeling2 <- full_join(modeling2, mswabreg, by = "locid")
modeling2 <- full_join(modeling2, mswabdef, by = "locid")
modeling2 <- full_join(modeling2, mswabdef1, by = "locid")
fit <- lm(hrec_lncon ~ neighbor + hr_sex  + mswabdef1ec_lncon, data = modeling2)
summary(fit)
fit <- lm(hrec_lncon ~ neighbor + hr_sex  + mswabdefec_lncon, data = modeling2)
summary(fit)
fit <- lm(hrec_lncon ~ neighbor + hr_sex  + mswabdef1ec_lncon, data = modeling2)
summary(fit)
library(dplyr)
library(xlsx)
library(xlsx)
library(dplyr)
df.envir <- read.xlsx("C:/users/wmairin/Downloads/handrinse.xlsx", 1)
swab <- df.envir %>%  filter(samtype == 9)
table(swab$sw_type)
table(swab$sw_def)
sum(is.na(swab$sw_type))
sum(is.na(swab$sw_def))
table(df.envir$sw_av)
hr <- df.envir %>%  filter(samtype == 8) %>% select(locid, hrec_lncon = ec_lncon, environ, neighbor, hr_sex, hr_agecat) %>% subset(!is.na(locid))
part <- df.envir %>%  filter(samtype == 2) %>% select(locid, partec_lncon = ec_lncon) %>% subset(!is.na(locid))
water <- df.envir %>%  filter(samtype == 4) %>% select(locid, waterec_lncon = ec_lncon) %>% subset(!is.na(locid))
swab <- df.envir %>%  filter(samtype == 9) %>% select(locid, swabec_lncon = ec_lncon) %>% subset(!is.na(locid))
swabirreg <- df.envir %>%  filter(samtype == 9 & sw_av == 1) %>% select(locid, swabirregec_lncon = ec_lncon) %>% subset(!is.na(locid))
swabreg <- df.envir %>%  filter(samtype == 9 & sw_av == 0) %>% select(locid, swabregec_lncon = ec_lncon) %>% subset(!is.na(locid))
swabdef <- df.envir %>%  filter(samtype == 9 & sw_def == 1) %>% select(locid, swabdefec_lncon = ec_lncon) %>% subset(!is.na(locid))
swabdef1 <- df.envir %>%  filter(samtype == 9 & sw_def == 0) %>% select(locid, swabdef1ec_lncon = ec_lncon) %>% subset(!is.na(locid))
mpart <- part %>% group_by(locid) %>% summarise_each(funs(mpartec_lncon = mean(., na.rm=TRUE)))
mwater <- water %>% group_by(locid) %>% summarise_each(funs(mwaterec_lncon = mean(., na.rm=TRUE)))
mswab <- swab %>% group_by(locid) %>% summarise_each(funs(mswabec_lncon = mean(., na.rm=TRUE)))
mswabirreg <- swabirreg %>% group_by(locid) %>% summarise_each(funs(mswabirregec_lncon = mean(., na.rm=TRUE)))
mswabreg <- swabreg %>% group_by(locid) %>% summarise_each(funs(mswabregec_lncon = mean(., na.rm=TRUE)))
mswabdef <- swabdef %>% group_by(locid) %>% summarise_each(funs(mswabdefec_lncon = mean(., na.rm=TRUE)))
mswabdef1 <- swabdef1 %>% group_by(locid) %>% summarise_each(funs(mswabdef1ec_lncon = mean(., na.rm=TRUE)))
modeling2 <- full_join(hr, mpart, by = "locid")
modeling2 <- full_join(modeling2, mwater, by = "locid")
modeling2 <- full_join(modeling2, mswab, by = "locid")
modeling2 <- full_join(modeling2, mswabirreg, by = "locid")
modeling2 <- full_join(modeling2, mswabreg, by = "locid")
modeling2 <- full_join(modeling2, mswabdef, by = "locid")
modeling2 <- full_join(modeling2, mswabdef1, by = "locid")
modeling22 <- modeling2[complete.cases(modeling2$mswabdefec_lncon), ]
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mpartec_lncon + mwaterec_lncon +
mswabec_lncon, data = modeling22)
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mpartec_lncon + mwaterec_lncon +
mswabec_lncon, data = modeling2)
summary(fit)
fit <- lm(hrec_lncon ~ neighbor + hr_sex  + mswabdefec_lncon, data = modeling2)
summary(fit)
fit <- lm(hrec_lncon ~ neighbor + hr_sex  + mswabdef1ec_lncon, data = modeling2)
summary(fit)
View(mswabdef)
View(swabdef)
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mpartec_lncon + mwaterec_lncon +
mswabdefec_lncon, data = modeling2)
summary(fit)
View(swabdef)
library(waffle)
library(extrafont)
install.packages("Rttf2pt1")
install.packages("Rttf2pt1")
install.packages("Rttf2pt1")
install.packages("Rttf2pt1")
library(extrafont)
waffle(parts/10, rows=3, colors=c("#969696", "#1879bf", "#009bda"),
use_glyph="medkit", size=8)
library(waffle)
library(extrafont)
waffle(parts/10, rows=3, colors=c("#969696", "#1879bf", "#009bda"),
use_glyph="medkit", size=8)
parts <- c(`Un-breached\nUS Population`=(318-11-79), `Premera`=11, `Anthem`=79)
waffle(parts/10, rows=3, colors=c("#969696", "#1879bf", "#009bda"),
use_glyph="medkit", size=8)
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mpartec_lncon + mwaterec_lncon +
mswabec_lncon, data = modeling2)
summary(fit)
fit <- lm(hrec_lncon ~ neighbor + hr_sex  + mswabdefec_lncon, data = modeling2)
summary(fit)
fit <- lm(hrec_lncon ~ neighbor + hr_sex  + mswabdef1ec_lncon, data = modeling2)
summary(fit)
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mpartec_lncon + mwaterec_lncon +
mswabec_lncon, data = modeling2)
summary(fit)
modeling22 <- modeling2[complete.cases(modeling2$mswabdefec_lncon), ]
View(modeling22)
fit <- lm(hrec_lncon ~ neighbor + hr_sex  + mswabdefec_lncon, data = modeling2)
summary(fit)
fit <- lm(hrec_lncon ~ neighbor + hr_sex  + mswabdef1ec_lncon, data = modeling2)
summary(fit)
View(swabdef1)
View(swabdef)
fit <- glm(hrec_lncon ~ neighbor + hr_sex  + mswabdefec_lncon, data = modeling2)
summary(fit)
fit <- gmm(hrec_lncon ~ neighbor + hr_sex  + mswabdefec_lncon, data = modeling2)
df.envir$ec_conc_adj <- df.envir$ec_conc/df.envir$sw_area
View(df.envir)
df.envir$ec_lnconc_adj <- ln(df.envir$ec_conc_adj)
df.envir$ec_lnconc_adj <- log10(df.envir$ec_conc_adj)
View(df.envir)
df.envir$ec_conc_adj <- (df.envir$ec_conc/df.envir$sw_area) * 100
df.envir$ec_lnconc_adj <- log10(df.envir$ec_conc_adj)
df.envir <- read.xlsx("C:/users/wmairin/Downloads/handrinse.xlsx", 1)
hr <- df.envir %>%  filter(samtype == 8) %>% select(locid, hrec_conc_adj = ec_conc_adj, environ, neighbor, hr_sex, hr_agecat) %>% subset(!is.na(locid))
part <- df.envir %>%  filter(samtype == 2) %>% select(locid, partec_conc_adj = ec_conc_adj) %>% subset(!is.na(locid))
water <- df.envir %>%  filter(samtype == 4) %>% select(locid, waterec_conc_adj = ec_conc_adj) %>% subset(!is.na(locid))
View(df.envir)
df.envir$ec_conc_adj <- (df.envir$ec_conc/df.envir$sw_area)
hr <- df.envir %>%  filter(samtype == 8) %>% select(locid, hrec_conc_adj = ec_conc_adj, environ, neighbor, hr_sex, hr_agecat) %>% subset(!is.na(locid))
part <- df.envir %>%  filter(samtype == 2) %>% select(locid, partec_conc_adj = ec_conc_adj) %>% subset(!is.na(locid))
water <- df.envir %>%  filter(samtype == 4) %>% select(locid, waterec_conc_adj = ec_conc_adj) %>% subset(!is.na(locid))
swab <- df.envir %>%  filter(samtype == 9) %>% select(locid, swabec_conc_adj = ec_conc_adj) %>% subset(!is.na(locid))
swabirreg <- df.envir %>%  filter(samtype == 9 & sw_av == 1) %>% select(locid, swabirregec_conc_adj = ec_conc_adj) %>% subset(!is.na(locid))
swabreg <- df.envir %>%  filter(samtype == 9 & sw_av == 0) %>% select(locid, swabregec_conc_adj = ec_conc_adj) %>% subset(!is.na(locid))
swabdef <- df.envir %>%  filter(samtype == 9 & sw_def == 1) %>% select(locid, swabdefec_conc_adj = ec_conc_adj) %>% subset(!is.na(locid))
swabdef1 <- df.envir %>%  filter(samtype == 9 & sw_def == 0) %>% select(locid, swabdef1ec_conc_adj = ec_conc_adj) %>% subset(!is.na(locid))
mpart <- part %>% group_by(locid) %>% summarise_each(funs(mpartec_conc_adj = mean(., na.rm=TRUE)))
mwater <- water %>% group_by(locid) %>% summarise_each(funs(mwaterec_conc_adj = mean(., na.rm=TRUE)))
mswab <- swab %>% group_by(locid) %>% summarise_each(funs(mswabec_conc_adj = mean(., na.rm=TRUE)))
mswabirreg <- swabirreg %>% group_by(locid) %>% summarise_each(funs(mswabirregec_conc_adj = mean(., na.rm=TRUE)))
mswabreg <- swabreg %>% group_by(locid) %>% summarise_each(funs(mswabregec_conc_adj = mean(., na.rm=TRUE)))
mswabdef <- swabdef %>% group_by(locid) %>% summarise_each(funs(mswabdefec_conc_adj = mean(., na.rm=TRUE)))
mswabdef1 <- swabdef1 %>% group_by(locid) %>% summarise_each(funs(mswabdef1ec_conc_adj = mean(., na.rm=TRUE)))
modeling2 <- full_join(hr, mpart, by = "locid")
modeling2 <- full_join(modeling2, mwater, by = "locid")
modeling2 <- full_join(modeling2, mswab, by = "locid")
modeling2 <- full_join(modeling2, mswabirreg, by = "locid")
modeling2 <- full_join(modeling2, mswabreg, by = "locid")
modeling2 <- full_join(modeling2, mswabdef, by = "locid")
modeling2 <- full_join(modeling2, mswabdef1, by = "locid")
fit <- gmm(hrec_conc_adj ~ neighbor + hr_sex  + mswabdefec_conc_adj, data = modeling2)
fit <- lm(hrec_conc_adj ~ neighbor + hr_sex  + mswabdefec_conc_adj, data = modeling2)
View(df.envir)
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mpartec_lncon + mwaterec_lncon +
mswabec_lncon, data = modeling2)
hr <- df.envir %>%  filter(samtype == 8) %>% select(locid, hrec_lncon = ec_lncon, environ, neighbor, hr_sex, hr_agecat) %>% subset(!is.na(locid))
part <- df.envir %>%  filter(samtype == 2) %>% select(locid, partec_lncon = ec_lncon) %>% subset(!is.na(locid))
water <- df.envir %>%  filter(samtype == 4) %>% select(locid, waterec_lncon = ec_lncon) %>% subset(!is.na(locid))
swab <- df.envir %>%  filter(samtype == 9) %>% select(locid, swabec_lncon = ec_lncon) %>% subset(!is.na(locid))
swabirreg <- df.envir %>%  filter(samtype == 9 & sw_av == 1) %>% select(locid, swabirregec_lncon = ec_lncon) %>% subset(!is.na(locid))
swabreg <- df.envir %>%  filter(samtype == 9 & sw_av == 0) %>% select(locid, swabregec_lncon = ec_lncon) %>% subset(!is.na(locid))
swabdef <- df.envir %>%  filter(samtype == 9 & sw_def == 1) %>% select(locid, swabdefec_lncon = ec_lncon) %>% subset(!is.na(locid))
swabdef1 <- df.envir %>%  filter(samtype == 9 & sw_def == 0) %>% select(locid, swabdef1ec_lncon = ec_lncon) %>% subset(!is.na(locid))
mpart <- part %>% group_by(locid) %>% summarise_each(funs(mpartec_lncon = mean(., na.rm=TRUE)))
mwater <- water %>% group_by(locid) %>% summarise_each(funs(mwaterec_lncon = mean(., na.rm=TRUE)))
mswab <- swab %>% group_by(locid) %>% summarise_each(funs(mswabec_lncon = mean(., na.rm=TRUE)))
mswabirreg <- swabirreg %>% group_by(locid) %>% summarise_each(funs(mswabirregec_lncon = mean(., na.rm=TRUE)))
mswabreg <- swabreg %>% group_by(locid) %>% summarise_each(funs(mswabregec_lncon = mean(., na.rm=TRUE)))
mswabdef <- swabdef %>% group_by(locid) %>% summarise_each(funs(mswabdefec_lncon = mean(., na.rm=TRUE)))
mswabdef1 <- swabdef1 %>% group_by(locid) %>% summarise_each(funs(mswabdef1ec_lncon = mean(., na.rm=TRUE)))
modeling2 <- full_join(hr, mpart, by = "locid")
modeling2 <- full_join(modeling2, mwater, by = "locid")
modeling2 <- full_join(modeling2, mswab, by = "locid")
modeling2 <- full_join(modeling2, mswabirreg, by = "locid")
modeling2 <- full_join(modeling2, mswabreg, by = "locid")
modeling2 <- full_join(modeling2, mswabdef, by = "locid")
modeling2 <- full_join(modeling2, mswabdef1, by = "locid")
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mpartec_lncon + mwaterec_lncon +
mswabec_lncon, data = modeling2)
summary(fit)
hr <- df.envir %>%  filter(samtype == 8) %>% select(locid, hrec_lncon = ec_conc_adj, environ, neighbor, hr_sex, hr_agecat) %>% subset(!is.na(locid))
hr <- df.envir %>%  filter(samtype == 8) %>% select(locid, hrec_conc_adj = ec_conc_adj, environ, neighbor, hr_sex, hr_agecat) %>% subset(!is.na(locid))
part <- df.envir %>%  filter(samtype == 2) %>% select(locid, partec_conc_adj = ec_conc_adj) %>% subset(!is.na(locid))
swab <- df.envir %>%  filter(samtype == 9) %>% select(locid, swabec_conc_adj = ec_conc_adj) %>% subset(!is.na(locid))
swabirreg <- df.envir %>%  filter(samtype == 9 & sw_av == 1) %>% select(locid, swabirregec_conc_adj = ec_conc_adj) %>% subset(!is.na(locid))
water <- df.envir %>%  filter(samtype == 4) %>% select(locid, waterec_conc_adj = ec_conc_adj) %>% subset(!is.na(locid))
swabreg <- df.envir %>%  filter(samtype == 9 & sw_av == 0) %>% select(locid, swabregec_conc_adj = ec_conc_adj) %>% subset(!is.na(locid))
swabdef <- df.envir %>%  filter(samtype == 9 & sw_def == 1) %>% select(locid, swabdefec_conc_adj = ec_conc_adj) %>% subset(!is.na(locid))
swabdef1 <- df.envir %>%  filter(samtype == 9 & sw_def == 0) %>% select(locid, swabdef1ec_conc_adj = ec_conc_adj) %>% subset(!is.na(locid))
mpart <- part %>% group_by(locid) %>% summarise_each(funs(mpartec_conc_adj = mean(., na.rm=TRUE)))
mwater <- water %>% group_by(locid) %>% summarise_each(funs(mwaterec_conc_adj = mean(., na.rm=TRUE)))
mswab <- swab %>% group_by(locid) %>% summarise_each(funs(mswabec_conc_adj = mean(., na.rm=TRUE)))
mswabirreg <- swabirreg %>% group_by(locid) %>% summarise_each(funs(mswabirregec_conc_adj = mean(., na.rm=TRUE)))
mswabreg <- swabreg %>% group_by(locid) %>% summarise_each(funs(mswabregec_conc_adj = mean(., na.rm=TRUE)))
mswabdef <- swabdef %>% group_by(locid) %>% summarise_each(funs(mswabdefec_conc_adj = mean(., na.rm=TRUE)))
mswabdef1 <- swabdef1 %>% group_by(locid) %>% summarise_each(funs(mswabdef1ec_conc_adj = mean(., na.rm=TRUE)))
modeling2 <- full_join(hr, mpart, by = "locid")
modeling2 <- full_join(modeling2, mwater, by = "locid")
modeling2 <- full_join(modeling2, mswab, by = "locid")
modeling2 <- full_join(modeling2, mswabirreg, by = "locid")
modeling2 <- full_join(modeling2, mswabreg, by = "locid")
modeling2 <- full_join(modeling2, mswabdef, by = "locid")
modeling2 <- full_join(modeling2, mswabdef1, by = "locid")
View(modeling2)
df.envir <- read.xlsx("C:/users/wmairin/Downloads/handrinse.xlsx", 1)
swab <- df.envir %>%  filter(samtype == 9) %>%
mutate(ec_conc_adj = ec_conc/sw_area)
View(swab)
swab <- df.envir %>%  filter(samtype == 9) %>%
mutate(ec_conc_adj = ec_conc/sw_area) %>%
select(locid, swabec_lncon = ec_lncon) %>% subset(!is.na(locid))
View(swab)
hr <- df.envir %>%  filter(samtype == 8) %>% select(locid, hrec_lncon = ec_conc_adj, environ, neighbor, hr_sex, hr_agecat) %>% subset(!is.na(locid))
part <- df.envir %>%  filter(samtype == 2) %>% select(locid, partec_lncon = ec_conc_adj) %>% subset(!is.na(locid))
hr <- df.envir %>%  filter(samtype == 8) %>% select(locid, hrec_lncon = ec_lncon, environ, neighbor, hr_sex, hr_agecat) %>% subset(!is.na(locid))
part <- df.envir %>%  filter(samtype == 2) %>% select(locid, partec_lncon = ec_lncon) %>% subset(!is.na(locid))
water <- df.envir %>%  filter(samtype == 4) %>% select(locid, waterec_lncon = ec_lncon) %>% subset(!is.na(locid))
swab <- df.envir %>%  filter(samtype == 9) %>%
mutate(ec_conc_adj = ec_conc/sw_area) %>%
select(locid, swabec_lncon = ec_conc_adj) %>% subset(!is.na(locid))
mpart <- part %>% group_by(locid) %>% summarise_each(funs(mpartec_lncon = mean(., na.rm=TRUE)))
mwater <- water %>% group_by(locid) %>% summarise_each(funs(mwaterec_lncon = mean(., na.rm=TRUE)))
mswab <- swab %>% group_by(locid) %>% summarise_each(funs(mswabec_lncon = mean(., na.rm=TRUE)))
modeling2 <- full_join(hr, mpart, by = "locid")
modeling2 <- full_join(modeling2, mwater, by = "locid")
modeling2 <- full_join(modeling2, mswab, by = "locid")
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mpartec_lncon + mwaterec_lncon +
mswabec_lncon, data = modeling22)
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mpartec_lncon + mwaterec_lncon +
mswabec_lncon, data = modeling2)
summary(fit)
View(modeling2)
fit <- lm(hrec_lncon ~ neighbor + mswabec_lncon, data = modeling22)
summary(fit)
fit <- lm(hrec_lncon ~ neighbor + mswabec_lncon, data = modeling2)
summary(fit)
fit <- lm(hrec_lncon ~ mswabec_lncon, data = modeling2)
summary(fit)
swab <- df.envir %>%  filter(samtype == 9) %>%
mutate(ec_conc_adj = (ec_conc/sw_area)*100) %>%
select(locid, swabec_lncon = ec_conc_adj) %>% subset(!is.na(locid))
mpart <- part %>% group_by(locid) %>% summarise_each(funs(mpartec_lncon = mean(., na.rm=TRUE)))
mwater <- water %>% group_by(locid) %>% summarise_each(funs(mwaterec_lncon = mean(., na.rm=TRUE)))
mswab <- swab %>% group_by(locid) %>% summarise_each(funs(mswabec_lncon = mean(., na.rm=TRUE)))
modeling2 <- full_join(hr, mpart, by = "locid")
modeling2 <- full_join(modeling2, mwater, by = "locid")
modeling2 <- full_join(modeling2, mswab, by = "locid")
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mpartec_lncon + mwaterec_lncon +
mswabec_lncon, data = modeling2)
summary(fit)
fit <- lm(hrec_lncon ~ neighbor + mswabec_lncon, data = modeling2)
summary(fit)
swab <- df.envir %>%  filter(samtype == 9) %>%
mutate(ec_conc_adj = ec_conc/sw_area) %>%
select(locid, swabec_lncon = ec_conc_adj) %>% subset(!is.na(locid))
mpart <- part %>% group_by(locid) %>% summarise_each(funs(mpartec_lncon = mean(., na.rm=TRUE)))
mwater <- water %>% group_by(locid) %>% summarise_each(funs(mwaterec_lncon = mean(., na.rm=TRUE)))
mswab <- swab %>% group_by(locid) %>% summarise_each(funs(mswabec_lncon = mean(., na.rm=TRUE)))
modeling2 <- full_join(hr, mpart, by = "locid")
modeling2 <- full_join(modeling2, mwater, by = "locid")
modeling2 <- full_join(modeling2, mswab, by = "locid")
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mpartec_lncon + mwaterec_lncon +
mswabec_lncon, data = modeling2)
summary(fit)
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mswabec_lncon, data = modeling2)
summary(fit)
fit <- lm(hrec_lncon ~ neighbor + mswabec_lncon, data = modeling2)
summary(fit)
View(df.envir)
library(dplyr)
library(xlsx)
df.envir <- read.xlsx("C:/users/wmairin/Downloads/handrinse.xlsx", 1)
hr <- df.envir %>%  filter(samtype == 8) %>% select(locid, hrec_lncon = ec_lncon, environ, neighbor, hr_sex, hr_agecat) %>% subset(!is.na(locid))
part <- df.envir %>%  filter(samtype == 2) %>% select(locid, partec_lncon = ec_lncon) %>% subset(!is.na(locid))
water <- df.envir %>%  filter(samtype == 4) %>% select(locid, waterec_lncon = ec_lncon) %>% subset(!is.na(locid))
swab <- df.envir %>%  filter(samtype == 9) %>%
mutate(ec_conc_adj = ec_conc/sw_area) %>%
select(locid, swabec_lncon = ec_conc_adj) %>% subset(!is.na(locid))
mpart <- part %>% group_by(locid) %>% summarise_each(funs(mpartec_lncon = mean(., na.rm=TRUE)))
mwater <- water %>% group_by(locid) %>% summarise_each(funs(mwaterec_lncon = mean(., na.rm=TRUE)))
mswab <- swab %>% group_by(locid) %>% summarise_each(funs(mswabec_lncon = mean(., na.rm=TRUE)))
View(mswab)
hr <- df.envir %>%  filter(samtype == 8) %>% select(locid, hrec_lncon = ec_lncon, environ, neighbor, hr_sex, hr_agecat) %>% subset(!is.na(locid))
part <- df.envir %>%  filter(samtype == 2) %>% select(locid, partec_lncon = ec_lncon) %>% subset(!is.na(locid))
water <- df.envir %>%  filter(samtype == 4) %>% select(locid, waterec_lncon = ec_lncon) %>% subset(!is.na(locid))
swab <- df.envir %>%  filter(samtype == 9) %>%
mutate(ec_conc_adj = ec_conc/sw_area) %>%
select(locid, swabec_lncon = ec_conc_adj) %>% subset(!is.na(locid))
mpart <- part %>% group_by(locid) %>% summarise_each(funs(mpartec_lncon = mean(., na.rm=TRUE)))
mwater <- water %>% group_by(locid) %>% summarise_each(funs(mwaterec_lncon = mean(., na.rm=TRUE)))
mswab <- swab %>% group_by(locid) %>% summarise_each(funs(mswabec_con = mean(., na.rm=TRUE)))
modeling2 <- full_join(hr, mpart, by = "locid")
modeling2 <- full_join(modeling2, mwater, by = "locid")
modeling2 <- full_join(modeling2, mswab, by = "locid")
View(modeling2)
hr <- df.envir %>%  filter(samtype == 8) %>% select(locid, hrec_con = ec_con, environ, neighbor, hr_sex, hr_agecat) %>% subset(!is.na(locid))
hr <- df.envir %>%  filter(samtype == 8) %>% select(locid, hrec_conc = ec_conc, environ, neighbor, hr_sex, hr_agecat) %>% subset(!is.na(locid))
hr <- df.envir %>%  filter(samtype == 8) %>% select(locid, hrec_conc = ec_conc, environ, neighbor, hr_sex, hr_agecat) %>% subset(!is.na(locid))
part <- df.envir %>%  filter(samtype == 2) %>% select(locid, partec_conc = ec_conc) %>% subset(!is.na(locid))
water <- df.envir %>%  filter(samtype == 4) %>% select(locid, waterec_conc = ec_conc) %>% subset(!is.na(locid))
swab <- df.envir %>%  filter(samtype == 9) %>%
mutate(ec_conc_adj = ec_conc/sw_area) %>%
select(locid, swabec_conc = ec_conc_adj) %>% subset(!is.na(locid))
mpart <- part %>% group_by(locid) %>% summarise_each(funs(mpartec_conc = mean(., na.rm=TRUE)))
mwater <- water %>% group_by(locid) %>% summarise_each(funs(mwaterec_conc = mean(., na.rm=TRUE)))
mswab <- swab %>% group_by(locid) %>% summarise_each(funs(mswabec_conc = mean(., na.rm=TRUE)))
modeling2 <- full_join(hr, mpart, by = "locid")
modeling2 <- full_join(modeling2, mwater, by = "locid")
modeling2 <- full_join(modeling2, mswab, by = "locid")
modeling2$hrec_conc
fit <- lm(hrec_lncon ~ neighbor + hr_sex + mpartec_lncon + mwaterec_lncon +
mswabec_lncon, data = modeling2)
fit <- lm(hrec_conc ~ neighbor + hr_sex + mpartec_conc + mwaterec_conc +
mswabec_conc, data = modeling2)
summary(fit)
version()
version
fit <- lm(hrec_conc ~ neighbor + hr_sex + mpartec_conc + mwaterec_conc +
mswabec_conc, data = modeling2)
summary(fit)
install.packages("benchmarkme")
library(benchmarkme)
install.packages("benchmarkmeData")
install.packages("benchmarkme")
install.packages("benchmarkme")
install.packages("benchmarkme")
library(benchmarkme)
res <- benchmark_io(runs = 1, size = 5)
fit <- lm(hrec_conc ~ neighbor + hr_sex + mpartec_conc + mwaterec_conc +
mswabec_conc, data = modeling2)
summary(fit)
fit <- lm(hrec_conc ~ neighbor + hr_sex + mswabec_conc, data = modeling2)
summary(fit)
fit <- lm(hrec_conc ~ neighbor + mswabec_conc, data = modeling2)
summary(fit)
fit <- lm(hrec_conc ~ neighbor + hr_sex + mpartec_conc + mwaterec_conc +
mswabec_conc, data = modeling2)
summary(fit)
View(modeling2)
fit <- lm(hrec_conc ~ neighbor + hr_sex + mpartec_conc + mwaterec_conc +
mswabec_conc, data = modeling2)
summary(fit)
fit <- lm(hrec_conc ~ neighbor + hr_sex + mswabec_conc, data = modeling2)
summary(fit)
fit <- lm(hrec_conc ~ neighbor + mswabec_conc, data = modeling2)
summary(fit)
View(modeling2)
fit <- glm(hrec_conc ~ neighbor + hr_sex + mpartec_conc + mwaterec_conc +
mswabec_conc, data = modeling2)
summary(fit)
View(modeling2)
install.packages("rgdal")
setwd("H:\Work\accra_ghana_neighborhoods\accra_shapefiles_individual")
library(rgdal)
setwd("H:\Work\accra_ghana_neighborhoods\accra_shapefiles_individual")
neighb <- readOGR(".","abbossey_okai")
library("rgdal", lib.loc="~/R/R-3.4.0/library")
detach("package:rgdal", unload=TRUE)
library("rgdal", lib.loc="~/R/R-3.4.0/library")
install.packages("sp")
install.packages("sp")
library(rgdal)
setwd("H:\Work\accra_ghana_neighborhoods\accra_shapefiles_individual")
neighb <- readOGR(".","abbossey_okai")
neighb <- readOGR(dsn = getwd(), laye r= "abbossey_okai")
neighb <- readOGR(dsn = getwd(), layer= "abbossey_okai")
library(raster)
install.packages("raster")
library(raster)
setwd("H:\Work\accra_ghana_neighborhoods\accra_shapefiles_individual")
neighb <- readOGR(dsn = getwd(), layer= "abbossey_okai")
paste0(getwd(), "abbossey_okai.shp")
setwd("H:\Work\accra_ghana_neighborhoods\accra_shapefiles_individual\")
neighb <- readOGR(dsn = getwd(), layer= "abbossey_okai")
neighb <- shapefile(paste0(getwd(), "abbossey_okai.shp"))
setwd("H:\Work\accra_ghana_neighborhoods\accra_shapefiles_individual\")
neighb <- readOGR(dsn = getwd(), layer= "abbossey_okai")
neighb <- shapefile(paste0(getwd(), "abbossey_okai.shp"))
setwd("H:\Work\accra_ghana_neighborhoods\accra_shapefiles_individual")
setwd("H:\Work\accra_ghana_neighborhoods\accra_shapefiles_individual")
neighb <- shapefile("H:\Work\accra_ghana_neighborhoods\accra_shapefiles_individual\abbossey_okai.shp")
setwd("H:\Work\accra_ghana_neighborhoods\accra_shapefiles_individual")
detach("package:raster", unload=TRUE)
setwd("H:\Work\accra_ghana_neighborhoods\accra_shapefiles_individual")
library(rgdal)
library(raster)
library(rgeos)
dir <- "H:/work/accra_ghana_neighborhoods/accra_ghana.imposm-shapefiles"
waterways <- shapefile(paste0(dir, "/", "accra_ghana_osm_waterways_con_edited.shp"))
waterways <- spTransform(waterways, CRS("+proj=longlat +datum=WGS84"))
coord <- read.csv("H:/work/accra_ghana_neighborhoods/points_coordinates_output.csv", sep = ",")
the.points.sp <- SpatialPointsDataFrame(coord[, c("lon", "lat")], data.frame(ID=seq(1:nrow(coord))),
proj4string=CRS("+proj=longlat +datum=WGS84"))
the.points.projected <- spTransform(the.points.sp, CRS("+init=epsg:32630"))
the.circles.sp <- gBuffer(the.points.projected, width=100, byid=TRUE)
the.circles.projected <- spTransform(the.circles.sp, CRS("+proj=longlat +datum=WGS84"))
plot(waterways, col = "blue", axes=TRUE)
points(the.points.sp, col="red", cex=1)
points(intersec.points, col="green", cex=1)
the.points.sp <- SpatialPointsDataFrame(coord[, c("lon", "lat")], data.frame(ID=seq(1:nrow(coord))),
proj4string=CRS("+proj=longlat +datum=WGS84"))
the.points.projected <- spTransform(the.points.sp, CRS("+init=epsg:32630"))
the.circles.sp <- gBuffer(the.points.projected, width=100, byid=TRUE)
the.circles.projected <- spTransform(the.circles.sp, CRS("+proj=longlat +datum=WGS84"))
points(intersec.points, col="green", cex=1)
library(rgdal)
library(raster)
library(rgeos)
library(geosphere)
library(dplyr)
setwd("H:/GitHub/accra_drains/")
sewage <- shapefile(paste0(getwd(), "/shapefiles/waterways/", "accra_ghana_osm_waterways_con_edited.shp"))
sewage <- spTransform(sewage, CRS("+proj=longlat +datum=WGS84"))
neighbcoord <- read.csv(paste0(getwd(), "/data/", "points_coordinates_output.csv"), sep = ",")
ama <- shapefile(paste0(getwd(), "/shapefiles/neighborhood/", "AMA_projected.shp"))
ama <- spTransform(ama, CRS("+proj=longlat +datum=WGS84"))
line.length <- function(the.lines.projected, the.circles.projected) {
if (gIntersects(the.lines.projected, the.circles.projected)) {
lines_crp <- crop(the.lines.projected, the.circles.projected)
lines_crp_length <- gLength(lines_crp)
return(lines_crp_length)
} else {
return(0)
}
}
dat0 <- neighbcoord
the.points.sp <- SpatialPointsDataFrame(dat0[, c("lon", "lat")], data.frame(ID=seq(1:nrow(dat0))),
proj4string=CRS("+proj=longlat +datum=WGS84"))
the.sewage.projected <- spTransform(sewage, CRS( "+init=epsg:32630" ))
sewage.length <- c()
for (i in 1:length(the.points.sp[ ,1])) {
the.points.projected <- spTransform(the.points.sp[i, ], CRS( "+init=epsg:32630" ))
the.circles.projected <- gBuffer(the.points.projected, width=100, byid=TRUE)
sewage.length[i] <- line.length(the.sewage.projected, the.circles.projected)
}
dist2sewagedf <- data.frame(matrix(NA, nrow=1, ncol=4))
colnames(dist2sewagedf) <- c("distance", "lon", "lat", "ID")
for (i in 1:length(dat0[ ,1])) {
dist2sewagedf[i, ] <- rbind(dist2Line(dat0[i, c("lon", "lat")], sewage)) #coordinates of intersection
}
dist2sewage <- dist2sewagedf$distance
dist2sewagedf.adj <- dist2sewagedf %>% filter(!distance > 1500)
intersec.points <- SpatialPointsDataFrame(dist2sewagedf.adj[c("lon", "lat")],
data.frame(ID=seq(1:nrow(dist2sewagedf.adj))),
proj4string=CRS("+proj=longlat +datum=WGS84"))
intersec.points.sp <- spTransform(intersec.points, CRS( "+init=epsg:32630" ))
endpoint <- data.frame("lon" = c(-0.221109), "lat" = c(5.530075))
endpoint.proj <- SpatialPointsDataFrame(endpoint[c("lon", "lat")],
data.frame(ID=seq(1:nrow(endpoint))),
proj4string=CRS("+proj=longlat +datum=WGS84"))
endpoint.proj.sp <- spTransform(endpoint.proj, CRS( "+init=epsg:32630" ))
plot(sewage, col = "blue", axes=TRUE)
points(the.points.sp, col="red", cex=1)
points(intersec.points, col="green", cex=1)
points(endpoint.proj, cex=1)
library(riverdist)
setwd("H:/GitHub/accra_drains/shapefiles/waterways/")
MyRivernetwork <- line2network(path = getwd(), layer = accra_ghana_osm_waterways_con_edited.shp)
MyRivernetwork <- line2network(path = getwd(), layer = "accra_ghana_osm_waterways_con_edited")
setwd("H:/GitHub/accra_drains/shapefiles/waterways/")
MyRivernetwork <- line2network(path=".", layer="MyShapefile")
MyRivernetwork <- line2network(path = getwd(), layer = "accra_ghana_osm_waterways_con_edited")
proj <- "+proj=longlat +datum=WGS84"
MyRivernetwork <- line2network(path = getwd(), layer = "accra_ghana_osm_waterways_con_edited", reproject = "+proj=longlat +datum=WGS84")
data(Gulk)
plot(x=Gulk)
sewage <- shapefile(paste0(getwd(), "/shapefiles/waterways/", "accra_ghana_osm_waterways_con_edited.shp"))
sewage <- spTransform(sewage, CRS("+proj=longlat +datum=WGS84"))
setwd("H:/GitHub/accra_drains/")
sewage <- shapefile(paste0(getwd(), "/shapefiles/waterways/", "accra_ghana_osm_waterways_con_edited.shp"))
sewage <- spTransform(sewage, CRS("+proj=longlat +datum=WGS84"))
MyRivernetwork <- line2network(sewage)
topologydots(rivers=Gulk)
topologydots(sewage)
help(line2network)
proj <- "+proj=longlat +datum=WGS84"
MyRivernetwork <- line2network(path = getwd(), layer = "accra_ghana_osm_waterways_con_edited", reproject = proj,
tolerance = 100)
setwd("H:/GitHub/accra_drains/shapefiles/waterways/")
MyRivernetwork <- line2network(path = getwd(), layer = "accra_ghana_osm_waterways_con_edited", reproject = proj,
tolerance = 100)
MyRivernetwork <- line2network(path = getwd(), layer = "accra_ghana_osm_waterways_con_edited", reproject = proj,
tolerance = 10)
